<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>Extract_ficheros_codificados_huse_hsisn2</name>
    <name_sync_with_filename>Y</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <parameters>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>-</created_user>
    <created_date>2025/03/12 09:01:46.392</created_date>
    <modified_user>-</modified_user>
    <modified_date>2025/03/12 09:01:46.392</modified_date>
  </info>
  <notepads>
  </notepads>
  <order>
    <hop>
      <from>Add CIE null</from>
      <to>Ordena codificados</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Ficheros NO codificados </from>
      <to>Add CIE null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Ficheros codificados</from>
      <to>Ordena codificados 2</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Mapper sexo</from>
      <to>Centro</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Ordena codificados</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Ordena codificados 2</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Centro</from>
      <to>Codficado</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Codficado</from>
      <to>Reorganización de Códigos</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Descripción HASH</from>
      <to>ZT_DOCLIB_CIE10_REGISTROS_TRATADOS</to>
      <enabled>N</enabled>
    </hop>
    <hop>
      <from>minusculas </from>
      <to>Quitar acentos i mejoras</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values</from>
      <to>minusculas </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Quitar acentos i mejoras</from>
      <to>Descripcion_tratado is not null</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Descripcion_tratado is not null</from>
      <to>Descripcion </to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Descripcion_tratado is not null</from>
      <to>Mapper sexo</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Reorganización de Códigos</from>
      <to>ZT_DOCLIB_CIE10_REGISTROS_TRATADOS</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>Add CIE null</name>
    <type>Constant</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <length>-1</length>
        <name>10</name>
        <precision>-1</precision>
        <set_empty_string>Y</set_empty_string>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>11</name>
        <precision>-1</precision>
        <set_empty_string>Y</set_empty_string>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>12</name>
        <precision>-1</precision>
        <set_empty_string>Y</set_empty_string>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>13</name>
        <precision>-1</precision>
        <set_empty_string>Y</set_empty_string>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>14</name>
        <precision>-1</precision>
        <set_empty_string>Y</set_empty_string>
        <type>String</type>
      </field>
      <field>
        <length>-1</length>
        <name>15</name>
        <precision>-1</precision>
        <set_empty_string>Y</set_empty_string>
        <type>String</type>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>592</xloc>
      <yloc>368</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Centro</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>// Suponemos que 'Fichero' es la variable que contiene el nombre del archivo.
var Centro = '';

// Comprobamos si el nombre del fichero contiene ciertas cadenas y asignamos valores correspondientes.
if (Fichero.indexOf('LLATZER') !== -1) {
    Centro= 'Son Llàtzer';
} else if (Fichero.indexOf('IBIZA') !== -1) {
    Centro= 'Can Misses';
} else if (Fichero.indexOf('ESPASES') !== -1) {
    Centro= 'Son Espases';
} else if (Fichero.indexOf('INCA') !== -1) {
    Centro= 'Hospital comarcal Inca';
} else {
    Centro= 'Desconocido';
}
// Asignamos el valor calculado a la variable 'centro', que será accesible como un nuevo campo.
Centro;
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>Centro</name>
        <rename>Centro</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1936</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Codficado</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>// Suponemos que 'Fichero' es la variable que contiene el nombre del archivo.
var Codificado= '';

// Comprobamos si el nombre del fichero contiene ciertas cadenas  COD es codificado y NC no codificado
if (Fichero.indexOf('_COD_') !== -1) {
    Codificado=  'Sí';
} else if (Fichero.indexOf('_NC_') !== -1) {
    Codificado='No';
} else {
    Codificado= 'Desconocido';
}
// Asignamos el valor calculado a la variable codificado que será accesible como un nuevo campo.
Codificado;
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>Codificado</name>
        <rename>Codificado</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>2144</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Descripcion </name>
    <type>Dummy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <attributes/>
    <GUI>
      <xloc>1568</xloc>
      <yloc>416</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Descripcion_tratado is not null</name>
    <type>FilterRows</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compare>
      <condition>
        <conditions>
</conditions>
        <function>IS NOT NULL</function>
        <leftvalue>Descripcion_tratado</leftvalue>
        <negated>N</negated>
        <operator>-</operator>
      </condition>
    </compare>
    <send_false_to>Descripcion </send_false_to>
    <send_true_to>Mapper sexo</send_true_to>
    <attributes/>
    <GUI>
      <xloc>1568</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Descripción HASH</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>//Script here
var desc_hash = org.apache.commons.codec.digest.DigestUtils.sha256Hex(Descripcion_tratado);
 
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>desc_hash</name>
        <rename>desc_hash</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>2800</xloc>
      <yloc>144</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Ficheros NO codificados </name>
    <type>TextFileInput2</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <accept_filenames>N</accept_filenames>
    <passing_through_fields>N</passing_through_fields>
    <accept_field/>
    <accept_transform_name/>
    <separator>|</separator>
    <enclosure/>
    <enclosure_breaks>N</enclosure_breaks>
    <escapechar/>
    <header>Y</header>
    <nr_headerlines>1</nr_headerlines>
    <footer>N</footer>
    <nr_footerlines>1</nr_footerlines>
    <line_wrapped>N</line_wrapped>
    <nr_wraps>1</nr_wraps>
    <layout_paged>N</layout_paged>
    <nr_lines_per_page>80</nr_lines_per_page>
    <nr_lines_doc_header>0</nr_lines_doc_header>
    <noempty>Y</noempty>
    <include>N</include>
    <include_field/>
    <rownum>N</rownum>
    <rownumByFile>N</rownumByFile>
    <rownum_field/>
    <format>DOS</format>
    <encoding>UTF-8</encoding>
    <length>Characters</length>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>C:\DADES\DOCLIB\CIE10\CODIFICADOS\</name>
      <filemask>.*._NC_.*\.TXT</filemask>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
      <name>C:\DADES\DOCLIB\CIE10\CODIFICADOS\</name>
      <filemask>.*._NC_.*\.txt</filemask>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
      <name/>
      <filemask/>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
      <type>CSV</type>
      <compression>None</compression>
    </file>
    <filters>
    </filters>
    <fields>
      <field>
        <name>0</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>1</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>2</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>3</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>4</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>5</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>60</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>6</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>7</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>8</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>17</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
    </fields>
    <limit>0</limit>
    <error_ignored>N</error_ignored>
    <skip_bad_files>N</skip_bad_files>
    <file_error_field/>
    <file_error_message_field/>
    <error_line_skipped>N</error_line_skipped>
    <error_count_field/>
    <error_fields_field/>
    <error_text_field/>
    <bad_line_files_destination_directory/>
    <bad_line_files_extension>warning</bad_line_files_extension>
    <error_line_files_destination_directory/>
    <error_line_files_extension>error</error_line_files_extension>
    <line_number_files_destination_directory/>
    <line_number_files_extension>line</line_number_files_extension>
    <date_format_lenient>Y</date_format_lenient>
    <date_format_locale>en_US</date_format_locale>
    <shortFileFieldName>Fichero</shortFileFieldName>
    <pathFieldName/>
    <hiddenFieldName/>
    <lastModificationTimeFieldName/>
    <uriNameFieldName/>
    <rootUriNameFieldName/>
    <extensionFieldName/>
    <sizeFieldName/>
    <attributes/>
    <GUI>
      <xloc>384</xloc>
      <yloc>416</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Ficheros codificados</name>
    <type>TextFileInput2</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <accept_filenames>N</accept_filenames>
    <passing_through_fields>N</passing_through_fields>
    <accept_field/>
    <accept_transform_name/>
    <separator>|</separator>
    <enclosure/>
    <enclosure_breaks>N</enclosure_breaks>
    <escapechar/>
    <header>Y</header>
    <nr_headerlines>1</nr_headerlines>
    <footer>N</footer>
    <nr_footerlines>1</nr_footerlines>
    <line_wrapped>N</line_wrapped>
    <nr_wraps>1</nr_wraps>
    <layout_paged>N</layout_paged>
    <nr_lines_per_page>80</nr_lines_per_page>
    <nr_lines_doc_header>0</nr_lines_doc_header>
    <noempty>Y</noempty>
    <include>N</include>
    <include_field/>
    <rownum>N</rownum>
    <rownumByFile>N</rownumByFile>
    <rownum_field/>
    <format>DOS</format>
    <encoding>UTF-8</encoding>
    <length>Characters</length>
    <add_to_result_filenames>Y</add_to_result_filenames>
    <file>
      <name>C:\DADES\DOCLIB\CIE10\CODIFICADOS\</name>
      <filemask>.*.COD.*\.TXT</filemask>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
      <name>C:\DADES\DOCLIB\CIE10\CODIFICADOS\</name>
      <filemask>.*.COD.*\.txt</filemask>
      <exclude_filemask/>
      <file_required>N</file_required>
      <include_subfolders>N</include_subfolders>
      <type>CSV</type>
      <compression>None</compression>
    </file>
    <filters>
    </filters>
    <fields>
      <field>
        <name>0</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>1</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>2</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>3</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>4</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>5</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>60</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>6</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>7</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>,</decimal>
        <group>.</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>15</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>8</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>17</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>10</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>6</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>11</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>0</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>12</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>0</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>13</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>0</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>14</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>0</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
      <field>
        <name>15</name>
        <type>String</type>
        <format/>
        <currency>$</currency>
        <decimal>.</decimal>
        <group>,</group>
        <nullif>-</nullif>
        <ifnull/>
        <position>-1</position>
        <length>0</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
        <repeat>N</repeat>
      </field>
    </fields>
    <limit>0</limit>
    <error_ignored>N</error_ignored>
    <skip_bad_files>N</skip_bad_files>
    <file_error_field/>
    <file_error_message_field/>
    <error_line_skipped>N</error_line_skipped>
    <error_count_field/>
    <error_fields_field/>
    <error_text_field/>
    <bad_line_files_destination_directory/>
    <bad_line_files_extension>warning</bad_line_files_extension>
    <error_line_files_destination_directory/>
    <error_line_files_extension>error</error_line_files_extension>
    <line_number_files_destination_directory/>
    <line_number_files_extension>line</line_number_files_extension>
    <date_format_lenient>Y</date_format_lenient>
    <date_format_locale>en_US</date_format_locale>
    <shortFileFieldName>Fichero</shortFileFieldName>
    <pathFieldName/>
    <hiddenFieldName/>
    <lastModificationTimeFieldName/>
    <uriNameFieldName/>
    <rootUriNameFieldName/>
    <extensionFieldName/>
    <sizeFieldName/>
    <attributes/>
    <GUI>
      <xloc>384</xloc>
      <yloc>224</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Mapper sexo</name>
    <type>ValueMapper</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <field_to_use>sexo</field_to_use>
    <fields>
      <field>
        <source_value>1</source_value>
        <target_value>Mujer</target_value>
      </field>
      <field>
        <source_value>0</source_value>
        <target_value>Hombre</target_value>
      </field>
    </fields>
    <target_field>sexo_str</target_field>
    <attributes/>
    <GUI>
      <xloc>1776</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Ordena codificados</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>0</name>
      </field>
      <field>
        <name>1</name>
      </field>
      <field>
        <name>2</name>
      </field>
      <field>
        <name>3</name>
      </field>
      <field>
        <name>4</name>
      </field>
      <field>
        <name>5</name>
      </field>
      <field>
        <name>6</name>
      </field>
      <field>
        <name>7</name>
      </field>
      <field>
        <name>8</name>
      </field>
      <field>
        <name>10</name>
      </field>
      <field>
        <name>11</name>
      </field>
      <field>
        <name>12</name>
      </field>
      <field>
        <name>13</name>
      </field>
      <field>
        <name>14</name>
      </field>
      <field>
        <name>15</name>
      </field>
      <field>
        <name>Fichero</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>736</xloc>
      <yloc>320</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Ordena codificados 2</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>0</name>
      </field>
      <field>
        <name>1</name>
      </field>
      <field>
        <name>2</name>
      </field>
      <field>
        <name>3</name>
      </field>
      <field>
        <name>4</name>
      </field>
      <field>
        <name>5</name>
      </field>
      <field>
        <name>6</name>
      </field>
      <field>
        <name>7</name>
      </field>
      <field>
        <name>8</name>
      </field>
      <field>
        <name>10</name>
      </field>
      <field>
        <name>11</name>
      </field>
      <field>
        <name>12</name>
      </field>
      <field>
        <name>13</name>
      </field>
      <field>
        <name>14</name>
      </field>
      <field>
        <name>15</name>
      </field>
      <field>
        <name>Fichero</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>736</xloc>
      <yloc>224</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Quitar acentos i mejoras</name>
    <type>ReplaceString</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>a</replace_by_string>
        <replace_string>á</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>e</replace_by_string>
        <replace_string>é</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>i</replace_by_string>
        <replace_string>í</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>a</replace_by_string>
        <replace_string>à</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>e</replace_by_string>
        <replace_string>è</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>o</replace_by_string>
        <replace_string>ó</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>o</replace_by_string>
        <replace_string>ò</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_string>.</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_string>,</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_string>(</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_string>)</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_string>[</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_string>]</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_string>/</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>entre el \1 y el \2 por ciento</replace_by_string>
        <replace_string>(\d+)\s*-\s*(\d+)\s*%</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>más del \1 por ciento</replace_by_string>
        <replace_string>&gt;\s*(\d+)\s*%</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>menos del \1 por ciento</replace_by_string>
        <replace_string>&lt;\s*(\d+)\s*%</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>primer</replace_by_string>
        <replace_string>\b1º\b</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>segundo</replace_by_string>
        <replace_string>\b2º\b</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>grados centígrados</replace_by_string>
        <replace_string>ºc|°c</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>neonatal </replace_by_string>
        <replace_string>\bneo[-\s]</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>postoperatorio </replace_by_string>
        <replace_string>\bpost[-\s]</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_by_string>sospecha de</replace_by_string>
        <replace_string>sospecha de[:]</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
      <field>
        <case_sensitive>N</case_sensitive>
        <in_stream_name>Descripcion_tratado</in_stream_name>
        <is_unicode>N</is_unicode>
        <replace_string>[\[\]…]</replace_string>
        <set_empty_string>N</set_empty_string>
        <use_regex>N</use_regex>
        <whole_word>N</whole_word>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1328</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Reorganización de Códigos</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>
/**
 * Este script reorganiza los códigos de codificación recibidos desde ficheros SAS que pueden contener hasta 6 códigos.
 * En muchos casos, los códigos no se encuentran secuencialmente organizados desde 'codificacion_1' en adelante.
 * Por ejemplo, puede haber situaciones donde 'codificacion_1' está vacío mientras que 'codificacion_5' contiene un valor,
 * o casos donde el único código disponible aparece en 'codificacion_5'.
 *
 * La función de este script es aglutinar todos los códigos no nulos y reorganizarlos comenzando desde 'codificacion_final_1',
 * asegurando que no haya espacios nulos entre los códigos validos al inicio de la lista de campos finales. Esto simplifica
 * el procesamiento posterior
 *
 * Proceso:
 * 1. Recolectar todos los valores no nulos de las variables 'codificacion_1' a 'codificacion_6'.
 * 2. Filtrar y almacenar solo los valores no nulos en un arreglo temporal.
 * 3. Rellenar los campos de salida 'codificacion_final_1' a 'codificacion_final_6' con los valores no nulos, en orden,
 *    empezando por 'codificacion_final_1'.
 * 4. Cualquier posición adicional sin valores no nulos
*/

// Recolectar valores no nulos en un array
var inputFields = [codificacion_1, codificacion_2, codificacion_3, codificacion_4, codificacion_5, codificacion_6];
var nonNullFields = inputFields.filter(function(value) {
    return value != null;
});

// Rellenar los campos finales moviendo los no nulos al inicio y dejando 'null' o "" al final
var outputFields = [codificacion_final_1, codificacion_final_2, codificacion_final_3, codificacion_final_4, codificacion_final_5, codificacion_final_6];
for (var i = 0; i &lt; outputFields.length; i++) {
    if (i &lt; nonNullFields.length) {
        outputFields[i] = nonNullFields[i]; // Asigna valores no nulos a la salida
    } else {
        outputFields[i] = ""; // Asigna valores nulos o cadenas vacías a las posiciones restantes
    }
}

// Asignar de nuevo a las variables individuales
var codificacion_final_1 = outputFields[0];
var codificacion_final_2 = outputFields[1];
var codificacion_final_3 = outputFields[2];
var codificacion_final_4 = outputFields[3];
var codificacion_final_5 = outputFields[4];
var codificacion_final_6 = outputFields[5];
</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>codificacion_final_1</name>
        <rename>codificacion_final_1</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>codificacion_final_2</name>
        <rename>codificacion_final_2</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>codificacion_final_3</name>
        <rename>codificacion_final_3</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>codificacion_final_4</name>
        <rename>codificacion_final_4</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>codificacion_final_5</name>
        <rename>codificacion_final_5</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>codificacion_final_6</name>
        <rename>codificacion_final_6</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>2352</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>0</name>
        <rename>identificador</rename>
      </field>
      <field>
        <name>1</name>
        <rename>fec_nacimiento</rename>
      </field>
      <field>
        <name>2</name>
        <rename>sexo</rename>
      </field>
      <field>
        <name>3</name>
        <rename>fec_contacto</rename>
      </field>
      <field>
        <name>4</name>
        <rename>cod_jc_en_reg_original</rename>
      </field>
      <field>
        <name>5</name>
        <rename>literal_original</rename>
      </field>
      <field>
        <name>6</name>
        <rename>cod_jc_al_alta</rename>
      </field>
      <field>
        <name>7</name>
        <rename>edad_en_dias</rename>
      </field>
      <field>
        <name>8</name>
        <rename>literal_1</rename>
      </field>
      <field>
        <name>10</name>
        <rename>codificacion_1</rename>
      </field>
      <field>
        <name>11</name>
        <rename>codificacion_2</rename>
      </field>
      <field>
        <name>12</name>
        <rename>codificacion_3</rename>
      </field>
      <field>
        <name>13</name>
        <rename>codificacion_4</rename>
      </field>
      <field>
        <name>14</name>
        <rename>codificacion_5</rename>
      </field>
      <field>
        <name>15</name>
        <rename>codificacion_6</rename>
      </field>
      <field>
        <name>Fichero</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <GUI>
      <xloc>960</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>ZT_DOCLIB_CIE10_REGISTROS_TRATADOS</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <commit>1000</commit>
    <connection>ZM</connection>
    <fields>
      <field>
        <column_name>identificador</column_name>
        <stream_name>identificador</stream_name>
      </field>
      <field>
        <column_name>fec_nacimiento</column_name>
        <stream_name>fec_nacimiento</stream_name>
      </field>
      <field>
        <column_name>sexo</column_name>
        <stream_name>sexo</stream_name>
      </field>
      <field>
        <column_name>fec_contacto</column_name>
        <stream_name>fec_contacto</stream_name>
      </field>
      <field>
        <column_name>cod_jc_en_reg_original</column_name>
        <stream_name>cod_jc_en_reg_original</stream_name>
      </field>
      <field>
        <column_name>literal_original</column_name>
        <stream_name>literal_original</stream_name>
      </field>
      <field>
        <column_name>cod_jc_al_alta</column_name>
        <stream_name>cod_jc_al_alta</stream_name>
      </field>
      <field>
        <column_name>edad_en_dias</column_name>
        <stream_name>edad_en_dias</stream_name>
      </field>
      <field>
        <column_name>literal_1</column_name>
        <stream_name>literal_1</stream_name>
      </field>
      <field>
        <column_name>CIE_1</column_name>
        <stream_name>codificacion_final_1</stream_name>
      </field>
      <field>
        <column_name>CIE_2</column_name>
        <stream_name>codificacion_final_2</stream_name>
      </field>
      <field>
        <column_name>CIE_3</column_name>
        <stream_name>codificacion_final_3</stream_name>
      </field>
      <field>
        <column_name>CIE_4</column_name>
        <stream_name>codificacion_final_4</stream_name>
      </field>
      <field>
        <column_name>CIE_5</column_name>
        <stream_name>codificacion_final_5</stream_name>
      </field>
      <field>
        <column_name>CIE_6</column_name>
        <stream_name>codificacion_final_6</stream_name>
      </field>
      <field>
        <column_name>Fichero</column_name>
        <stream_name>Fichero</stream_name>
      </field>
      <field>
        <column_name>Centro</column_name>
        <stream_name>Centro</stream_name>
      </field>
      <field>
        <column_name>Codificado</column_name>
        <stream_name>Codificado</stream_name>
      </field>
      <field>
        <column_name>literal_limpio</column_name>
        <stream_name>Descripcion_tratado</stream_name>
      </field>
    </fields>
    <ignore_errors>N</ignore_errors>
    <only_when_have_rows>N</only_when_have_rows>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_monthly>Y</partitioning_monthly>
    <return_field/>
    <return_keys>N</return_keys>
    <schema>ZM</schema>
    <specify_fields>Y</specify_fields>
    <table>ZT_DOCLIB_CIE10_REGISTROS_TRATADOS</table>
    <tablename_field/>
    <tablename_in_field>N</tablename_in_field>
    <tablename_in_table>Y</tablename_in_table>
    <truncate>Y</truncate>
    <use_batch>Y</use_batch>
    <attributes/>
    <GUI>
      <xloc>2752</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform>
    <name>minusculas </name>
    <type>StringOperations</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <in_stream_name>literal_original</in_stream_name>
        <out_stream_name>Descripcion_tratado</out_stream_name>
        <trim_type>both</trim_type>
        <lower_upper>lower</lower_upper>
        <padding_type>none</padding_type>
        <pad_char/>
        <pad_len/>
        <init_cap>no</init_cap>
        <mask_xml>none</mask_xml>
        <digits>none</digits>
        <remove_special_characters>none</remove_special_characters>
      </field>
    </fields>
    <attributes/>
    <GUI>
      <xloc>1120</xloc>
      <yloc>256</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes/>
</pipeline>
