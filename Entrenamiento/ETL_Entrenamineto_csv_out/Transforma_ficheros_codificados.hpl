<?xml version="1.0" encoding="UTF-8"?>
<pipeline>
  <info>
    <name>Transforma_ficheros_codificados</name>
    <name_sync_with_filename>Y</name_sync_with_filename>
    <description/>
    <extended_description/>
    <pipeline_version/>
    <pipeline_type>Normal</pipeline_type>
    <parameters>
    </parameters>
    <capture_transform_performance>N</capture_transform_performance>
    <transform_performance_capturing_delay>1000</transform_performance_capturing_delay>
    <transform_performance_capturing_size_limit>100</transform_performance_capturing_size_limit>
    <created_user>-</created_user>
    <created_date>2025/03/07 14:12:15.836</created_date>
    <modified_user>-</modified_user>
    <modified_date>2025/03/07 14:12:15.836</modified_date>
  </info>
  <notepads>
  </notepads>
  <order>
    <hop>
      <from>ZT_DOCLIB_CIE10_REGISTROS_TRATADOS</from>
      <to>Database lookup</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <transform>
    <name>ZT_DOCLIB_CIE10_REGISTROS_TRATADOS</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>ZM</connection>
    <execute_each_row>N</execute_each_row>
    <limit>10</limit>
    <sql>SELECT 
    R.IDENTIFICADOR AS SAS_IDENTIFICADOR,
    R.FEC_NACIMIENTO AS SAS_FEC_NACIMIENTO,
    R.SEXO AS SAS_SEXO,
    R.FEC_CONTACTO AS SAS_FEC_CONTACTO,
    R.COD_JC_EN_REG_ORIGINAL AS SAS_COD_JC_EN_REG_ORIGINAL,
    R.COD_JC_AL_ALTA AS SAS_COD_JC_AL_ALTA,
    R.EDAD_EN_DIAS AS SAS_EDAD_EN_DIAS,
    R.FICHERO AS SAS_FICHERO,
    R.CENTRO AS SAS_CENTRO,
    R.CODIFICADO AS SAS_CODIFICADO,
    R.LITERAL_ORIGINAL AS SAS_LITERAL_ORIGINAL,
    R.LITERAL_1 AS SAS_LITERAL_1,
    R.CODIFICACION_1 AS SAS_CODIFICACION_1,
    R.LITERAL_2 AS SAS_LITERAL_2,
    R.CODIFICACION_2 AS SAS_CODIFICACION_2,
    R.LITERAL_3 AS SAS_LITERAL_3,
    R.CODIFICACION_3 AS SAS_CODIFICACION_3,
    R.CODIFICACION_4 AS SAS_CODIFICACION_4,
    D.CIP AS CMBD_CIP,
    D.HISTORIA AS CMBD_HISTORIA,
    D.RESIDE_CP AS CMBD_RESIDE_CP,
    D.TIPOCONT AS CMBD_TIPOCONT,
    D.PROCEDENCIA AS CMBD_PROCEDENCIA,
    D.CIRCONT AS CMBD_CIRCONT,
    D.CEN_SAN AS CMBD_CEN_SAN,
    D.CCAA AS CMBD_CCAA,
    D.CENORI AS CMBD_CENORI,
    D.CENDEST AS CMBD_CENDEST,
    D.NUMEPI AS CMBD_NUMEPI,
    D.GRD AS CMBD_GRD,
    D.SEVER AS CMBD_SEVER,
    D.CDM AS CMBD_CDM,
    D.DISPOSITIVO_CONTINUIDAD AS CMBD_DISPOSITIVO_CONTINUIDAD,
    D.VERSION_GRD AS CMBD_VERSION_GRD,
    D.TIPO_GRD AS CMBD_TIPO_GRD,
    D.PESO_GRD AS CMBD_PESO_GRD,
    D.EM_ESP AS CMBD_EM_ESP,
    D.PROB_MORT_ESP AS CMBD_PROB_MORT_ESP,
    D.RIESGO_MORT AS CMBD_RIESGO_MORT,
    D.TASA_READ_ESPERADA AS CMBD_TASA_READ_ESPERADA,
    D.TASA_CMA_ESPERADA AS CMBD_TASA_CMA_ESPERADA,
    D.M1 AS CMBD_M1,
    D.M2 AS CMBD_M2,
    D.M3 AS CMBD_M3
FROM 
    ZM.ZT_DOCLIB_CIE10_REGISTROS_TRATADOS R
LEFT JOIN 
    ZM.ZE_CMBD_DOCLIB D
ON 
    R.IDENTIFICADOR = D.NUMEPI
</sql>
    <variables_active>N</variables_active>
    <attributes/>
    <GUI>
      <xloc>224</xloc>
      <yloc>208</yloc>
    </GUI>
  </transform>
  <transform>
    <name>Database lookup</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <cache>N</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <connection>DM</connection>
    <lookup>
      <eat_row_on_failure>N</eat_row_on_failure>
      <fail_on_multiple>N</fail_on_multiple>
      <key>
        <condition>=</condition>
        <field>ATR_NUMEPI</field>
        <name>IDENTIFICADOR</name>
        <name2/>
      </key>
      <orderby/>
      <schema>DM</schema>
      <table>WF_CMBD_DOCLIB</table>
      <value>
        <default/>
        <name>ATR_EM_ESP</name>
        <rename>ATR_EM_ESP</rename>
        <trim_type>none</trim_type>
        <type>Number</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECCODI</name>
        <rename>ATR_FECCODI</rename>
        <trim_type>none</trim_type>
        <type>Timestamp</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECFINCONT</name>
        <rename>ATR_FECFINCONT</rename>
        <trim_type>none</trim_type>
        <type>Timestamp</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECINGHOSP</name>
        <rename>ATR_FECINGHOSP</rename>
        <trim_type>none</trim_type>
        <type>Timestamp</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECINHOSP</name>
        <rename>ATR_FECINHOSP</rename>
        <trim_type>none</trim_type>
        <type>Timestamp</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECINICONT</name>
        <rename>ATR_FECINICONT</rename>
        <trim_type>none</trim_type>
        <type>Timestamp</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECINT</name>
        <rename>ATR_FECINT</rename>
        <trim_type>none</trim_type>
        <type>Timestamp</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECNAC_numb</name>
        <rename>ATR_FECNAC_numb</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECPART</name>
        <rename>ATR_FECPART</rename>
        <trim_type>none</trim_type>
        <type>Timestamp</type>
      </value>
      <value>
        <default/>
        <name>ATR_HISTORIA</name>
        <rename>ATR_HISTORIA</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>ATR_MOTIVOURG</name>
        <rename>ATR_MOTIVOURG</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>ATR_NUMEPI</name>
        <rename>ATR_NUMEPI</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>ORIGEN</name>
        <rename>ORIGEN</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>ATR_PESO_GRD</name>
        <rename>ATR_PESO_GRD</rename>
        <trim_type>none</trim_type>
        <type>Number</type>
      </value>
      <value>
        <default/>
        <name>ATR_PROB_MORT_ESP</name>
        <rename>ATR_PROB_MORT_ESP</rename>
        <trim_type>none</trim_type>
        <type>Number</type>
      </value>
      <value>
        <default/>
        <name>ATR_READ_MISMO_GRD</name>
        <rename>ATR_READ_MISMO_GRD</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>ATR_READ_MISMO_SERV</name>
        <rename>ATR_READ_MISMO_SERV</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>ATR_RIESGO_MORT</name>
        <rename>ATR_RIESGO_MORT</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>ATR_SEC</name>
        <rename>ATR_SEC</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>ATR_SECC_DP</name>
        <rename>ATR_SECC_DP</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>SEVER</name>
        <rename>SEVER</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>ATR_TASA_CMA_ESPERADA</name>
        <rename>ATR_TASA_CMA_ESPERADA</rename>
        <trim_type>none</trim_type>
        <type>Number</type>
      </value>
      <value>
        <default/>
        <name>ATR_TASA_READ_ESPERADA</name>
        <rename>ATR_TASA_READ_ESPERADA</rename>
        <trim_type>none</trim_type>
        <type>Number</type>
      </value>
      <value>
        <default/>
        <name>ATR_TIPO_GRD</name>
        <rename>ATR_TIPO_GRD</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>ATR_UNENF</name>
        <rename>ATR_UNENF</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>ATR_VERSION_GRD</name>
        <rename>ATR_VERSION_GRD</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>CENDEST</name>
        <rename>CENDEST</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>CENORI</name>
        <rename>CENORI</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>CEN_SAN</name>
        <rename>CEN_SAN</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>CIAS</name>
        <rename>CIAS</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>CODI</name>
        <rename>CODI</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>DIAS_UCI</name>
        <rename>DIAS_UCI</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>EDAT_PAC</name>
        <rename>EDAT_PAC</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECCODI_HORA_WID</name>
        <rename>FECCODI_HORA_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECCODI_WID</name>
        <rename>FECCODI_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECFINCONT_HORA_WID</name>
        <rename>FECFINCONT_HORA_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECFINCONT_WID</name>
        <rename>FECFINCONT_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECINGHOSP_WID</name>
        <rename>FECINGHOSP_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECINHOSP_WID</name>
        <rename>FECINHOSP_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECINICONT_WID</name>
        <rename>FECINICONT_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECINT_WID</name>
        <rename>FECINT_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>FECPART_WID</name>
        <rename>FECPART_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>MEDALTA</name>
        <rename>MEDALTA</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>N_DIAGNOSTICO</name>
        <rename>N_DIAGNOSTICO</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>PRIORIDAD_DIAGNOSTICO</name>
        <rename>PRIORIDAD_DIAGNOSTICO</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>PRIORIDAD_MORF</name>
        <rename>PRIORIDAD_MORF</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>PRIORIDAD_PROC</name>
        <rename>PRIORIDAD_PROC</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>TIPO_PROCEDIMIENTO</name>
        <rename>TIPO_PROCEDIMIENTO</rename>
        <trim_type>none</trim_type>
        <type>String</type>
      </value>
      <value>
        <default/>
        <name>GRD_WID</name>
        <rename>GRD_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>GRD_ULTIMO_WID</name>
        <rename>GRD_ULTIMO_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>ALCRONIC_WID</name>
        <rename>ALCRONIC_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>AREA_ATENCIO_URG_WID</name>
        <rename>AREA_ATENCIO_URG_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>AT_NOFIN_WID</name>
        <rename>AT_NOFIN_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>CAUSA_EXT_WID</name>
        <rename>CAUSA_EXT_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>CGUC_WID</name>
        <rename>CGUC_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>TRANSPORT_WID</name>
        <rename>TRANSPORT_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>CIRCONT_WID</name>
        <rename>CIRCONT_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>DISPOSITIVO_CONTINUIDAD_WID</name>
        <rename>DISPOSITIVO_CONTINUIDAD_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>SERVICIO_WID</name>
        <rename>SERVICIO_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>TIP_CIP_WID</name>
        <rename>TIP_CIP_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>TIPCODI_WID</name>
        <rename>TIPCODI_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>TIPOCONT_WID</name>
        <rename>TIPOCONT_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>TIPVISITA_WID</name>
        <rename>TIPVISITA_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>UCI_WID</name>
        <rename>UCI_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>TIPO_FINANCIACION_WID</name>
        <rename>TIPO_FINANCIACION_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>PROCEDENCIA_WID</name>
        <rename>PROCEDENCIA_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>MOTIVO_ALTA_WID</name>
        <rename>MOTIVO_ALTA_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>MORFOLOGICO_WID</name>
        <rename>MORFOLOGICO_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>POA_WID</name>
        <rename>POA_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>PROCEDIMIENTO_WID</name>
        <rename>PROCEDIMIENTO_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>DIAGNOSTICO_WID</name>
        <rename>DIAGNOSTICO_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>PACIENTE_WID</name>
        <rename>PACIENTE_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>PROFESIONAL_WID</name>
        <rename>PROFESIONAL_WID</rename>
        <trim_type>none</trim_type>
        <type>Integer</type>
      </value>
      <value>
        <default/>
        <name>ATR_FECNAC</name>
        <rename>ATR_FECNAC</rename>
        <trim_type>none</trim_type>
        <type>Timestamp</type>
      </value>
    </lookup>
    <attributes/>
    <GUI>
      <xloc>1232</xloc>
      <yloc>208</yloc>
    </GUI>
  </transform>
  <transform_error_handling>
  </transform_error_handling>
  <attributes/>
</pipeline>
